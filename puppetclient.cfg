# Kickstart file automatically generated by anaconda.

#version=DEVEL
install
cdrom
#url --url http://mirror.centos.org/centos/6.6/os/x86_64/
lang en_US.UTF-8
keyboard it
#network --onboot no --device eth0 --bootproto dhcp --noipv6
network --device eth0 --hostname puppetclient.example.com --bootproto=static --ip=192.168.122.100 --netmask=255.255.255.0 gatway=192.168.122.1 --nameserver=8.8.8.8
rootpw  --iscrypted $6$UvFAN1cPcTqNkp7K$PzxqE12YlVrim0wdQtP2uCpViNi9VZWOQl2VWr.NfmzuHLO8exZCWwN5JllEp/g2ns0Nku70hxy8FFwciBTnb.
firewall --service=ssh
authconfig --enableshadow --passalgo=sha512
selinux --enforcing
timezone --utc Europe/Rome
bootloader --location=mbr --driveorder=sda --append="console=tty0 console=ttyS0,115200n8 vga=normal"
# The following is the partition information you requested
# Note that any partitions you deleted are not expressed
# here so unless you clear all partitions first, this is
# not guaranteed to work
zerombr yes
clearpart --initlabel --linux --drives=sda --all

part /boot --fstype=ext4 --size=500
part pv.008002 --grow --size=1

volgroup vgpuppetclient --pesize=4096 pv.008002
logvol / --fstype=ext4 --name=lv_root --vgname=vgpuppetclient --grow --size=1024 --maxsize=51200
logvol swap --name=lv_swap --vgname=vgpuppetclient --grow --size=1024 --maxsize=1024

#repo --name="CentOS"  --baseurl=cdrom:sr0 --cost=100
repo --name="CentOS Base"  --baseurl=http://mirror.centos.org/centos/6.6/os/x86_64/ --cost=200

%packages --nobase
@core
wget
%end

%post
rpm -ivh http://yum.puppetlabs.com/puppetlabs-release-el-6.noarch.rpm
yum -y install puppet
chkconfig puppet on
#mv /etc/puppet/puppet.conf /etc/puppet/puppet.conf.old
wget -q -O /etc/puppet/puppet.conf http://192.168.122.217/agent.cfg
echo "192.168.122.217 puppetserver.example.com puppetserver" >> /etc/hosts
echo "192.168.122.100 puppetclient.example.com puppetclient" >> /etc/hosts
%end
